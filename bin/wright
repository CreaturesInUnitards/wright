#! /usr/bin/env node

/* eslint no-console: 0 */

const minimist = require('minimist')
    , fs = require('fs')
    , path = require('path')
    , wright = require('../lib/')
    , pkg = require('../package.json')

const command = minimist(process.argv.slice(2), {
  alias: {
    r: 'run',
    f: 'fps',
    h: 'help',
    s: 'serve',
    w: 'watch',
    v: 'version',
    d: 'debug'
  },
  boolean: ['debug', 'fps']
})

command.main = command._[0] || command.main

const help = command.help || command.main === 'help'
const version = command.version || command.main === 'version'

if (help)
  return console.log(fs.readFileSync(path.join(__dirname, 'help.txt'), 'utf8').replace('${version}', pkg.version))
else if (version)
  return console.log('wright version ' + pkg.version)

wright({
  main: command.main,
  reload: command.reload,
  fps: command.fps,
  serve: command.serve,
  debug: command.debug
}).catch(err => console.error(err))
